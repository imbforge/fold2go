process {
    withName: ALPHAFOLD {
        container  = "registry.gitlab.rlp.net/imbforge/imb-registry/alphafold@sha256:8694c152c4ad95d1fd434f97d6a2a1568a233bc00054580cace9c52eb9dbf166"

        cpus       = 2
        time       = { meta.size() * 1.h * task.attempt }
        memory     = 16.GB

        publishDir =
            [
                [
                    path: { "${params.OUT}/${workflow.runName}/predictions/${meta*.value.join('.')}" },
                    saveAs: { path -> path.split('/').last() }
                ]
            ]
    }
}

process {
    withName: MSA {
        container  = "registry.gitlab.rlp.net/imbforge/imb-registry/alphafold@sha256:8694c152c4ad95d1fd434f97d6a2a1568a233bc00054580cace9c52eb9dbf166"

        cpus       = 4
        time       = { 1.h * task.attempt }
        memory     = 64.GB

        publishDir =
            [
                [
                    path: { "${params.OUT}/msa/${record.id}" },
                    saveAs: { path -> path.split('/').last() }
                ]
            ]
    }
}
